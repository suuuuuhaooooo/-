<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è˜‡æ˜Šæ•¸ç†ï½œå®¶æ•™èª²è¡¨</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');

    :root {
        --primary: #8e9775;
        --secondary: #a2aab0;
        --bg-gradient: linear-gradient(135deg, #e9e9e9 0%, #f5f5f5 100%);
        --card-bg: rgba(255, 255, 255, 0.95);
        --text-dark: #545b64;
        --unavailable-bg: #e8e8e8;
        --available-bg: #ffffff;
    }

    body {
        font-family: "Noto Sans TC", sans-serif;
        background: var(--bg-gradient);
        color: var(--text-dark);
        margin: 0;
        padding: 30px 15px;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
    }

    .container {
        width: 100%;
        max-width: 1000px;
        background: var(--card-bg);
        padding: 50px 30px;
        border-radius: 40px;
        box-shadow: 0 25px 60px rgba(0,0,0,0.08);
        backdrop-filter: blur(15px);
        animation: fadeInUp 0.8s ease-out;
    }

    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }

    header { text-align: center; margin-bottom: 40px; }
    .badge {
        display: inline-block;
        background: var(--primary);
        color: white;
        padding: 6px 20px;
        border-radius: 50px;
        font-size: 13px;
        font-weight: 500;
        letter-spacing: 2px;
        margin-bottom: 15px;
    }

    h1 { margin: 0; font-size: 32px; color: #3d444d; font-weight: 700; }

    .info-bar {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
        font-size: 12px;
        color: #999;
        padding: 0 10px;
    }

    .table-wrapper { width: 100%; overflow-x: auto; padding: 10px 0; }

    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 8px 10px;
        min-width: 750px;
    }

    th {
        background-color: var(--secondary);
        color: white;
        font-weight: 500;
        padding: 18px 10px;
        border-radius: 12px;
        font-size: 16px;
    }

    td {
        text-align: center;
        padding: 15px 5px;
        border-radius: 12px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        height: 65px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.02);
    }

    .time-label {
        background-color: #f1f3f5;
        font-size: 13px;
        font-weight: 700;
        color: #888;
        width: 120px;
        line-height: 1.4;
    }

    td.x {
        background-color: var(--unavailable-bg);
        color: #b0b0b0;
        position: relative;
        cursor: not-allowed;
    }
    
    td.x::after {
    content: "å·²é ç´„\00000aReserved"; 
    white-space: pre; 
    font-size: 10px;
    display: block;
    opacity: 0.5;
    letter-spacing: 1px;
    margin-top: 2px;
    line-height: 1.2; /* å»ºè­°èª¿æ•´è¡Œé«˜ï¼Œè®“æ›è¡Œå¾Œçš„é–“è·æ›´ç¾è§€ */
    }

    td:not(.x):not(.time-label) {
        background-color: var(--available-bg);
        border: 1px solid #f0f0f0;
    }

    td:not(.x):not(.time-label):hover {
        background-color: #fff;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.06);
        border-color: var(--primary);
        z-index: 10;
        cursor: pointer;
    }

    footer { margin-top: 45px; padding-top: 30px; border-top: 1px solid #eee; text-align: center; }
    .btn-group { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-top: 20px; }
    .nav-btn { display: inline-block; padding: 12px 30px; border-radius: 50px; text-decoration: none; font-weight: 500; font-size: 16px; transition: 0.3s; }
    .btn-outline { border: 1.5px solid var(--primary); color: var(--primary); }
    .btn-outline:hover { background: var(--primary); color: white; }
    .btn-filled { background: #06c755; color: white; box-shadow: 0 10px 20px rgba(6, 199, 85, 0.15); }
    .btn-filled:hover { transform: scale(1.05); box-shadow: 0 12px 25px rgba(6, 199, 85, 0.25); }
</style>
</head>
<body>

<div class="container">
    <header>
        <span class="badge">PROFESSIONAL TUTORING</span>
        <h1>114-2 å­¸æœŸæ’èª²ç¸½è¡¨</h1>
    </header>

    <div class="info-bar">
        <span>â€» é»æ“Šç©ºç™½è™•å¯å³æ™‚è¯ç¹«é ç´„</span>
        <span id="update-date">è®€å–ä¸­...</span>
    </div>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th style="background:#b8beb5">æ™‚æ®µ</th>
                    <th>ä¸€</th><th>äºŒ</th><th>ä¸‰</th><th>å››</th><th>äº”</th><th>å…­</th><th>æ—¥</th>
                </tr>
            </thead>
            <tbody id="schedule-body">
                <tr><td colspan="8" style="text-align:center; padding: 50px; color:#ccc;">è³‡æ–™åº«åŒæ­¥ä¸­ï¼Œè«‹ç¨å€™...</td></tr>
            </tbody>
        </table>
    </div>

    <footer>
        <p>å¦‚éœ€å®‰æ’è©¦æ•™æˆ–èª¿æ•´æ™‚é–“ï¼Œæ­¡è¿ç›´æ¥è¯ç¹«æ´½è©¢</p>
        <div class="btn-group">
            <a href="profile.html" class="nav-btn btn-outline">æŸ¥çœ‹å¸«è³‡ç°¡ä»‹</a>
            <a href="https://line.me/ti/p/~@000gwomo" class="nav-btn btn-filled">ç«‹å³è¯ç¹«å®˜æ–¹ LINE</a>
        </div>
    </footer>
</div>

<script>
    // ğŸ’¡ é€™è£¡å¡«å…¥ä½ éƒ¨ç½²å¾—åˆ°çš„ Apps Script ç¶²å€
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyV1ygP4g7yNr_xYTN9DkWppOlCD0oKb8pW_UC2AAyFaLHDO0VJKUfv2myJq0QNM5shBQ/exec';

    async function syncSchedule() {
        try {
            const response = await fetch(SCRIPT_URL);
            const data = await response.json();
            
            // 1. é¡¯ç¤ºçœŸæ­£çš„æœ€å¾Œå­˜æª”æ™‚é–“
            document.getElementById('update-date').innerText = 'æœ€å¾Œæ›´æ–°ï¼š' + data.lastUpdated;

            // 2. æ¸²æŸ“è¡¨æ ¼å…§å®¹
            const body = document.getElementById('schedule-body');
            body.innerHTML = ''; 

            data.schedule.forEach(row => {
                const tr = document.createElement('tr');
                
                row.forEach((cell, index) => {
                    const td = document.createElement('td');
                    const val = cell ? cell.toString().trim().toLowerCase() : '';

                    if (index === 0) {
                        // ç¬¬ä¸€æ¬„ï¼šæ™‚æ®µæ¨™ç±¤
                        td.className = 'time-label';
                        td.innerText = cell;
                    } else if (val === 'x') {
                        // å·²é ç´„ï¼šåŠ ä¸Š .x class
                        td.className = 'x';
                    } else {
                        // å¯é ç´„ï¼šå¢åŠ è·³è½‰åŠŸèƒ½
                        td.onclick = () => { window.location.href = "https://line.me/ti/p/~@000gwomo"; };
                    }
                    tr.appendChild(td);
                });
                body.appendChild(tr);
            });

        } catch (error) {
            console.error('åŒæ­¥å¤±æ•—:', error);
            document.getElementById('update-date').innerText = 'ç‹€æ…‹ï¼šæš«æ™‚ç„¡æ³•é€£ç·š';
        }
    }

    // å•Ÿå‹•åŒæ­¥
    syncSchedule();
</script>

</body>
</html>
